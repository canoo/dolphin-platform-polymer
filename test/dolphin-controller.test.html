<script src="../bower_components/webcomponentsjs/webcomponents-loader.js"></script>
<script src="../bower_components/web-component-tester/browser.js"></script>
<link rel="import" href="../dolphin-controller.html">

<test-fixture id="simple-fixture">
  <template>
    <dolphin-controller></dolphin-controller>
  </template>
</test-fixture>

<script>
  const dolphinContext = {
    beanManager: {
      onBeanUpdate: (callback) => {},
      onArrayUpdate: (callback) => {},
      notifyBeanChange: () => {},
      notifyArrayChange: () => {},
    },
    createController: (name) => {
      return Promise.resolve({
        model: {},
        onDestroyed: () => {}
      })
    }
  }
  const controllerName = "fooController"

  suite("<dolphin-controller>", () => {

    test("simple use case", (done) => {
      // given:
      const element = fixture("simple-fixture")

      // when:
      element.dolphinContext = dolphinContext
      element.name = controllerName
      expect(element.state).to.equal("INITIALIZING")

      // then:
      flush(() => {
        expect(element.state).to.equal("READY")
        done()
      })
    })

  })
</script>